import pandas as pd


def reshape_kline(dt):
    """
    :param dt: original kline data
    :return: reshaped list
    example:
    [
      [
        1499040000000,      // Open time
        "0.01634790",       // Open
        "0.80000000",       // High
        "0.01575800",       // Low
        "0.01577100",       // Close
        "148976.11427815",  // Volume
        1499644799999,      // Close time
        "2434.19055334",    // Quote asset volume
        308,                // Number of trades
        "1756.87402397",    // Taker buy base asset volume
        "28.46694368",      // Taker buy quote asset volume
        "17928899.62484339" // Ignore
      ]
    ]
    """
    df = pd.DataFrame(dt)
    df = df.loc[:, [1, 2, 3, 4, 5, 7, 10, 8]]
    result = df.as_matrix().reshape(-1)
    return result


def reshape_depth(dt):
    mid = (dt['bids'][0][0] + dt['asks'][0][0]) / 2



def main():
    d = {'lastUpdateId': 77753648,
         'bids': [
             ['406.12000000', '0.68600000', []],
             ['406.11000000', '2.18200000', []],
             ['406.10000000', '12.06804000', []],
             ['406.02000000', '8.16837000', []],
             ['406.00000000', '23.91798000', []]
         ],
         'asks': [
             ['406.39000000', '3.00000000', []],
             ['406.40000000', '0.84860000', []],
             ['406.58000000', '0.04000000', []],
             ['406.61000000', '0.06000000', []],
             ['406.84000000', '11.77000000', []]
         ]}

    k = [[1522317000000, '411.80000000', '412.05000000', '411.00000000', '411.29000000', '86.18237000', 1522317059999,
          '35444.61420850', 71, '26.42364000', '10869.07510740', '0'],
         [1522317060000, '411.97000000', '411.98000000', '411.31000000', '411.98000000', '26.22442000', 1522317119999,
          '10795.17331340', 55, '24.27301000', '9992.31171800', '0'],
         [1522317120000, '411.98000000', '411.98000000', '410.55000000', '411.11000000', '112.29813000', 1522317179999,
          '46165.00743960', 112, '31.99385000', '13166.21379800', '0'],
         [1522317180000, '411.07000000', '411.92000000', '411.00000000', '411.88000000', '58.80279000', 1522317239999,
          '24174.61118720', 44, '53.85567000', '22140.60279920', '0'],
         [1522317240000, '411.83000000', '411.95000000', '411.00000000', '411.12000000', '52.36740000', 1522317299999,
          '21544.20149500', 46, '29.00578000', '11936.94745090', '0'],
         [1522317300000, '411.12000000', '411.64000000', '411.12000000', '411.16000000', '18.55743000', 1522317359999,
          '7632.34719320', 26, '1.08759000', '447.49453740', '0'],
         [1522317360000, '411.16000000', '411.98000000', '411.16000000', '411.25000000', '133.52731000', 1522317419999,
          '54926.07873590', 77, '124.28364000', '51124.73019580', '0'],
         [1522317420000, '411.25000000', '411.79000000', '410.91000000', '411.63000000', '46.85836000', 1522317479999,
          '19268.26440600', 48, '12.51087000', '5147.66869340', '0'],
         [1522317480000, '411.06000000', '411.79000000', '410.92000000', '411.47000000', '19.57439000', 1522317539999,
          '8045.57867150', 22, '1.77326000', '729.89542110', '0'],
         [1522317540000, '411.47000000', '411.59000000', '411.28000000', '411.59000000', '4.75792000', 1522317599999,
          '1958.11095290', 12, '4.57428000', '1882.58349370', '0']]
    ans = reshape_kline(k)
    print(ans)
    return


if __name__ == "__main__":
    main()
